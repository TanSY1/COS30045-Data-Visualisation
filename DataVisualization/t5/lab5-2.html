<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8"/>
	<meta name="description"	content="Data Visualisation Exercise 1"/>
	<meta name="keywords"		  content="HTML, CSS"/>
	<meta name="author"			  content="Your name here"/>

	<title>Task 5.1 D3 Updates</title>
	<script src="https://d3js.org/d3.v7.min.js"></script>
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

</head>

<body style="background-color:  rgb(164, 224, 233);">

	<h1>Update Data</h1>
	<button class="button1" style="background-color: rgb(44, 136, 223); color: white; border: 2px solid rgb(164, 224, 233);" >Update Once</button>
	<button class="button2" style="background-color: rgb(231, 174, 68); color: white; border: 2px solid rgb(164, 224, 233);">Transition 1</button>
	<button class="button3" style="background-color: rgb(44, 156, 22); color: white; border: 2px solid rgb(164, 224, 233);">Transition 2</button>

	<br><br>


	<script>

		var w = 500;
		var h = 150;
		var barPadding = 3;
	
		var dataset = [24, 10, 29, 19, 8, 15, 20, 12, 9, 6, 21, 28];

		var xScale = d3.scaleBand()
						.domain(d3.range(dataset.length))
						.rangeRound([0,w])
						.paddingInner(0.05);

		var yScale = d3.scaleLinear()
						.domain([0, d3.max(dataset)])
						.range([h, 0]);

		var svg = d3.select("body")
					.append("svg")
					.attr("width", w)
					.attr("height", h)
					.attr("fill", "rgb(106, 90, 205)");
		
		svg.selectAll("rect")
			.data(dataset)
			.enter()
			.append("rect")
			.attr("x", function(d, i){
				return xScale(i);
			})
			.attr("y", function(d){
				return yScale(d);
			})
			.attr("width", xScale.bandwidth())
			
			.attr("height", function(d){
				return h - yScale(d);
			});
	
		svg.selectAll("text")
		.data(dataset)
		.enter()
		.append("text")
		.text(function(d){
			return d;
		})
		.attr("fill", "black")
		.attr("text-anchor", "middle")
		.attr("x", function(d, i){
			return xScale(i) + xScale.bandwidth() / 2; 
		})
		.attr("y", function(d){
			return yScale(d) - 5; 
		})

		//update Once
		d3.select(".button1")
		.on("click", function() {
			var numValues = dataset.length;
			var dataset2 = [];
			var maxValue = 25;

			for(var i = 0; i < numValues; i++) {
				var newNumber = Math.floor(Math.random() * maxValue);
				dataset2.push(newNumber);
			}

			svg.selectAll("rect")
				.data(dataset2)
				.attr("y", function(d) {
					return yScale(d);
				})
				.attr("height", function(d) {
					return h - yScale(d);
				});

			svg.selectAll("text")
				.data(dataset2)
				.text(function(d) {
					return d;
				})
				.attr("text-anchor", "middle")
				.attr("x", function(d, i) {
					return xScale(i) + xScale.bandwidth() / 2;
				})
				.attr("y", function(d) {
					return yScale(d) - 5;
				});
		})

		//Transition 1
		d3.select(".button2")
		.on("click", function() {
			var numValues = dataset.length;
			var dataset2 = [];
			var maxValue = 25;

			for(var i = 0; i < numValues; i++) {
				var newNumber = Math.floor(Math.random() * maxValue);
				dataset2.push(newNumber);
			}

			svg.selectAll("rect")
				.data(dataset2)
				.transition()
				.duration(1000)
				.ease(d3.easeCubicInOut)
				.attr("y", function(d) {
					return yScale(d);
				})
				.attr("height", function(d) {
					return h - yScale(d);
				});

			svg.selectAll("text")
				.data(dataset2)
				.text(function(d) {
					return d;
				})
				.attr("text-anchor", "middle")
				.attr("x", function(d, i) {
					return xScale(i) + xScale.bandwidth() / 2;
				})
				.attr("y", function(d) {
					return yScale(d) - 5;
				});
		})

		//Transition 2
		d3.select(".button3")
		.on("click", function() {
			var numValues = dataset.length;
			var dataset2 = [];
			var maxValue = 25;

			for(var i = 0; i < numValues; i++) {
				var newNumber = Math.floor(Math.random() * maxValue);
				dataset2.push(newNumber);
			}

			svg.selectAll("rect")
				.data(dataset2)
				.transition()
				.delay(function(d, i) {
					return i/dataset2.length * 100;
				})
				.duration(2000)
				.ease(d3.easeCubicInOut)
				.attr("y", function(d) {
					return yScale(d);
				})
				.attr("height", function(d) {
					return h - yScale(d);
				});

			svg.selectAll("text")
				.data(dataset2)
				.text(function(d) {
					return d;
				})
				.attr("text-anchor", "middle")
				.attr("x", function(d, i) {
					return xScale(i) + xScale.bandwidth() / 2;
				})
				.attr("y", function(d) {
					return yScale(d) - 5;
				});
		})
		
	
		</script>
	<br>
	<bf></bf>
	
	<hr style="border: 1px solid">

	<a style="text-decoration: none;" href="../index.html">
		<button style="font-size:20px; background-color:rgb(174, 196, 238); border-radius: 10px; cursor: pointer;">
			Home</button>
	</a>

	<a style="text-decoration: none;" href="lab5-1.html">
		<button style="font-size:20px; background-color:rgb(174, 196, 238); border-radius: 10px; cursor: pointer;">
			Lab5.1</button>
	</a>	
	
	<a style="text-decoration: none;" href="lab5-3.html">
		<button style="font-size:20px; background-color:rgb(174, 196, 238); border-radius: 10px; cursor: pointer;">
			Lab5.3</button>
	</a>



	<br>
	<br>

	<footer style="text-align: center; padding: 20px;background-color: #6ed6ff; border-top: 2px dotted;">
		COS30045 Data Visualisation<br>
		Tan Shan Yan</footer>

</body>
</html>
